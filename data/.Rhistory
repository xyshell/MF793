setwd("C:/Users/47494/GitHub/MF793/data")
tbl_funds = read.csv('funds-1584g-mon.csv')
tbl_funds[1:5,]
View(tbl_funds)
std(tbl_funds)
sd(tbl_funds)
sapply(tbl_funds, sd, na.rm = TRUE)
std = sapply(tbl_funds, sd, na.rm = TRUE)
std
std = sapply(tbl_funds, sd)
std = sapply(tbl_funds, sd)
mean(std)
std[1:5]
std = sapply(tbl_funds, 2, sd)
std = apply(tbl_funds, 2, sd)
std[1:5]
std = sapply(tbl_funds[,2:], sd)
std = sapply(tbl_funds[,2:end], sd)
std = sapply(tbl_funds[,2:ncol(tbl_funds)], sd)
std[1:5]
std = sapply(tbl_funds[,1:ncol(tbl_funds)], sd)
std[1:5]
std = sapply(tbl_funds[,2:ncol(tbl_funds)], sd)
mean(std)
rnorm(60,0.01,avg_std)
avg_std <- mean(std)
rnorm(60,0.01,avg_std)
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) = c(60,100)
View(tbl_norm)
t.test(tbl_norm)
t.test(tbl_norm, mu=0.01)
temp <- t.test(tbl_norm, mu=0.01, conf.level = 0.95)
View(temp)
View(temp)
temp <- t.test(data = tbl_norm, mu=0.01, conf.level = 0.95)
tstat_tbl <- matrix(nrow=1,ncol=100)
tstat_tbl <- matrix(0,nrow=1,ncol=100)
View(tstat_tbl)
tbl_tstat <- matrix(0,nrow=1,ncol=100)
View(temp)
temp$statistic
t.test(tbl_norm, mu=0.01, conf.level = 0.95)$statistic
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm, mu=0.01, conf.level = 0.95)$statistic
}
View(tbl_tstat)
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic
}
View(tbl_tstat)
max(tbl_tstat)
high_tstat <- order(tbl_tstat,decreasing=TRUE)[1:5]
tbl_tstat
order(tbl_tstat,decreasing=TRUE)
tbl_tstat[order(tbl_tstat,decreasing=TRUE)[1:5]]
sort(tbl_tstat)
sort(tbl_tstat,decreasing = True)
sort(tbl_tstat,decreasing = TRUE)
sort(tbl_tstat,decreasing = TRUE)[1:5]
runif(5, min=1, max=100)
runif(5, min=1, max=100)
help(sample)
sample(c(1,2,3,4))
sample(c(1,2,3,4))
sample(c(1,2,3,4))
sample(tbl_tstat)
sample(tbl_tstat)
sample(tbl_tstat)
sample(tbl_tstat)[1:5]
sample(tbl_tstat)[1:5]
sample(tbl_tstat)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
high_tstat
high_tstat <- sort(tbl_tstat,decreasing = TRUE)[1:5]
high_tstat
tbl_high_tstat[i,]
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_high_tstat[i,] <- high_tstat
tbl_high_tstat[i,]
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) <- c(60,100)
tbl_tstat <- matrix(0,nrow=1,ncol=100)
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
for (j in 1:10000){
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic
}
high_tstat <- sort(tbl_tstat,decreasing = TRUE)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
tbl_high_tstat[i,] <- high_tstat
tbl_rand_tstat[i,] <- rand_tstat
}
View(tbl_high_tstat)
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) <- c(60,100)
tbl_tstat <- matrix(0,nrow=1,ncol=100)
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
for (j in 1:10000){
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic
}
high_tstat <- sort(tbl_tstat,decreasing = TRUE)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
tbl_high_tstat[j,] <- high_tstat
tbl_rand_tstat[j,] <- rand_tstat
}
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) <- c(60,100)
tbl_tstat <- matrix(0,nrow=1,ncol=100)
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
for (j in 1:10000){
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic
}
high_tstat <- sort(tbl_tstat,decreasing = TRUE)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
tbl_high_tstat[j,] <- high_tstat
tbl_rand_tstat[j,] <- rand_tstat
}
View(tbl_high_tstat)
tbl_tstat <- matrix(0,nrow=1,ncol=100)
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
for (j in 1:10000){
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) <- c(60,100)
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic
}
high_tstat <- sort(tbl_tstat,decreasing = TRUE)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
tbl_high_tstat[j,] <- high_tstat
tbl_rand_tstat[j,] <- rand_tstat
}
View(tbl_high_tstat)
View(tbl_high_tstat)
View(tbl_rand_tstat)
avg_std
mean(tbl_high_tstat)
colmean(tbl_high_tstat)
colMeans(tbl_high_tstat)
colMeans(tbl_high_tstat)
colMeans(tbl_rand_tstat)
View(tbl_rand_tstat)
round(colMeans(tbl_high_tstat),4)
round(colMeans(tbl_rand_tstat),4)
View(temp)
abs(tbl_high_tstat)>=2
sum(abs(tbl_high_tstat)>=2)
colSums(abs(tbl_high_tstat)>=2)
colSums(abs(tbl_high_tstat)>=2)/nrol(tbl_high_tstat)
colSums(abs(tbl_high_tstat)>=2)/nrow(tbl_high_tstat)
round(colSums(abs(tbl_high_tstat)>=2)/nrow(tbl_high_tstat),3)
round(colSums(abs(tbl_rand_tstat)>=2)/nrow(tbl_rand_tstat),3)
quantile(tbl_high_tstat, 0.975)
for (i in 1:5) {quantile(tbl_high_tstat[,i], 0.975)}
for (i in 1:5) {quantile_high <- quantile(tbl_high_tstat[,i], 0.975)}
quantile_high
quantile_high <- matrix(0,nrow=1,ncol=5)
quantile_rand <- matrix(0,nrow=1,ncol=5)
for (i in 1:5) {quantile_high[i] <- quantile(tbl_high_tstat[,i], 0.975)}
for (i in 1:5) {quantile_rand[i] <- quantile(tbl_rand_tstat[,i], 0.975)}
quantile_high
round(colMeans(tbl_high_tstat),4)
round(colMeans(tbl_rand_tstat),4)
round(colSums(abs(tbl_high_tstat)>=2)/nrow(tbl_high_tstat),3)
round(colSums(abs(tbl_rand_tstat)>=2)/nrow(tbl_rand_tstat),3)
quantile_high
quantile_high <- matrix(0,nrow=1,ncol=5)
quantile_rand <- matrix(0,nrow=1,ncol=5)
for (i in 1:5) {quantile_high[i] <- round(quantile(tbl_high_tstat[,i], 0.975),4)}
for (i in 1:5) {quantile_rand[i] <- round(quantile(tbl_rand_tstat[,i], 0.975),4)}
quantile_high
quantile_rand
hist(tbl_high_tstat[,5], nclass=40)
hist(tbl_high_tstat[,5], nclass=40, main="histogram of the fifth highest t-statistic")
hist(tbl_high_tstat[,5], nclass=40, main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=5)
abline(v=quantile_high[5], col="black",lwd=5)
hist(tbl_high_tstat[,5], nclass=200,
xlab="the fifth highest t-statistic",
main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=5)
abline(v=quantile_high[5], col="black",lwd=5)
hist(tbl_high_tstat[,5], nclass=100,
xlab="the fifth highest t-statistic",
main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=5)
abline(v=quantile_high[5], col="black",lwd=5)
hist(tbl_high_tstat[,5], nclass=100,
xlab="the fifth highest t-statistic",
main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=3)
abline(v=quantile_high[5], col="black",lwd=3)
x <- runif(10000, min=-2, max=2)
y <- runif(10000,x,2)
plot(density(y), main="marginal univariate density of y")
plot(density(y), xlab="y", main="marginal univariate density of y")
View(tbl_rand_tstat)
persp(kde2d(x, y),theta = 15, ticktype = "detailed",
xlab = "X", ylab = "Y", main="bivariate density of (X,Y)")
#(b)
library("MASS")
persp(kde2d(x, y),theta = 15, ticktype = "detailed",
xlab = "X", ylab = "Y", main="bivariate density of (X,Y)")
#(b)
tbl_tstat <- matrix(0,nrow=1,ncol=100)
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
for (j in 1:10000){
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) <- c(60,100)
for (i in 1:100) {
tbl_tstat[i] <- abs(t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic)
}
high_tstat <- sort(tbl_tstat,decreasing = TRUE)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
tbl_high_tstat[j,] <- high_tstat
tbl_rand_tstat[j,] <- rand_tstat
}
round(colMeans(tbl_high_tstat),4)
round(colMeans(tbl_rand_tstat),4)
round(colSums(abs(tbl_high_tstat)>=2)/nrow(tbl_high_tstat),3)
round(colMeans(tbl_rand_tstat),4)
# simulate normal random variables
tbl_tstat <- matrix(0,nrow=1,ncol=100)
tbl_high_tstat <- matrix(0,nrow=10000,ncol=5)
tbl_rand_tstat <- matrix(0,nrow=10000,ncol=5)
for (j in 1:10000){
tbl_norm <- rnorm(6000,0.01,avg_std)
dim(tbl_norm) <- c(60,100)
for (i in 1:100) {
tbl_tstat[i] <- t.test(tbl_norm[,i], mu=0.01, conf.level = 0.95)$statistic
}
high_tstat <- sort(abs(tbl_tstat),decreasing = TRUE)[1:5]
rand_tstat <- sample(tbl_tstat)[1:5]
tbl_high_tstat[j,] <- high_tstat
tbl_rand_tstat[j,] <- rand_tstat
}
round(colMeans(tbl_high_tstat),4)
round(colMeans(tbl_rand_tstat),4)
round(colSums(abs(tbl_high_tstat)>=2)/nrow(tbl_high_tstat),3)
round(colSums(abs(tbl_rand_tstat)>=2)/nrow(tbl_rand_tstat),3)
quantile_high <- matrix(0,nrow=1,ncol=5)
quantile_rand <- matrix(0,nrow=1,ncol=5)
for (i in 1:5) {quantile_high[i] <- round(quantile(tbl_high_tstat[,i], 0.975),4)}
for (i in 1:5) {quantile_rand[i] <- round(quantile(tbl_rand_tstat[,i], 0.975),4)}
quantile_high
quantile_rand
mean(y)
avg_std <- mean(std)
avg_std
# plot figure3
hist(tbl_high_tstat[,5], nclass=100,
xlab="the fifth highest t-statistic",
main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=3)
abline(v=quantile_high[5], col="black",lwd=3)
round(colMeans(tbl_high_tstat),4)
round(colMeans(tbl_rand_tstat),4)
round(colSums(abs(tbl_high_tstat)>=2)/nrow(tbl_high_tstat),3)
round(colSums(abs(tbl_rand_tstat)>=2)/nrow(tbl_rand_tstat),3)
quantile_high <- matrix(0,nrow=1,ncol=5)
quantile_rand <- matrix(0,nrow=1,ncol=5)
for (i in 1:5) {quantile_high[i] <- round(quantile(tbl_high_tstat[,i], 0.975),4)}
for (i in 1:5) {quantile_rand[i] <- round(quantile(tbl_rand_tstat[,i], 0.975),4)}
hist(tbl_high_tstat[,5], nclass=100,
xlab="the fifth highest t-statistic",
main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=3)
abline(v=quantile_high[5], col="black",lwd=3)
hist(tbl_high_tstat[,5], nclass=150,
xlab="the fifth highest t-statistic",
main="histogram of the fifth highest t-statistic")
abline(v=2, col="black",lwd=3)
abline(v=quantile_high[5], col="black",lwd=3)
